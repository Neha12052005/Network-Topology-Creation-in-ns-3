#include "ns3/core-module.h"
#include "ns3/network-module.h"
#include "ns3/internet-module.h"
#include "ns3/point-to-point-module.h"
#include "ns3/mobility-module.h"
#include "ns3/netanim-module.h"

using namespace ns3;

int main ()
{
    // 1. Create 25 nodes
    NodeContainer nodes;
    nodes.Create (25);

    // 2. Point-to-Point helper
    PointToPointHelper p2p;
    p2p.SetDeviceAttribute ("DataRate", StringValue ("10Mbps"));
    p2p.SetChannelAttribute ("Delay", StringValue ("2ms"));

    // 3. RING connections
    for (uint32_t i = 0; i < 24; i++)
    {
        p2p.Install (nodes.Get (i), nodes.Get (i + 1));
    }
    // Last node connected to first node
    p2p.Install (nodes.Get (24), nodes.Get (0));

    // 4. Internet stack
    InternetStackHelper internet;
    internet.Install (nodes);

    // 5. Mobility (CIRCULAR layout for ring)
    MobilityHelper mobility;
    Ptr<ListPositionAllocator> pos = CreateObject<ListPositionAllocator>();

    double centerX = 50.0;
    double centerY = 50.0;
    double radius  = 35.0;

    for (uint32_t i = 0; i < 25; i++)
    {
        double angle = 2 * M_PI * i / 25;
        pos->Add (Vector (centerX + radius * cos(angle),
                          centerY + radius * sin(angle),
                          0));
    }

    mobility.SetPositionAllocator (pos);
    mobility.SetMobilityModel ("ns3::ConstantPositionMobilityModel");
    mobility.Install (nodes);

    // 6. NetAnim
    AnimationInterface anim ("ring25.xml");

    Simulator::Stop (Seconds (10));
    Simulator::Run ();
    Simulator::Destroy ();

    return 0;
}
